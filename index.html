<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>HalloGenius!!! ‚Äì Abenteuer Lernen!</title>
  <!-- Font Awesome f√ºr Icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"/>
  <style>
    /* ===== PALETA ===== */
    :root {
      --blue:     #0052CC;
      --amber:    #F2A738;
      --coral:    #D45A56;
      --sky:      #87CEFA;
      --grass:    #7FC97F;
      --white:    #FFFFFF;
      --text:     #222222;
      --shadow:   rgba(0,0,0,0.2);
      --anim-time: 4s;
    }
    * { box-sizing: border-box; margin: 0; padding: 0; }
    body {
      font-family: 'Segoe UI', sans-serif;
      background: linear-gradient(180deg, var(--sky) 0%, #FFF5CC 80%);
      color: var(--text);
      overflow-x: hidden;
    }
    /* ===== HEADER ===== */
    header {
      position: sticky; top: 0;
      display: flex; align-items: center; justify-content: space-between;
      background: linear-gradient(135deg, var(--blue), var(--coral));
      color: var(--white);
      padding: 1rem 2rem;
      box-shadow: 0 4px 12px var(--shadow);
      z-index: 100;
      overflow: hidden;
    }
    header::before {
      content: '';
      position: absolute; inset: 0;
      background: radial-gradient(circle at top left, rgba(255,255,255,0.15), transparent 60%);
      animation: glow 6s infinite alternate;
    }
    @keyframes glow {
      from { opacity: 0.3; }
      to   { opacity: 0.6; }
    }
    header .logo {
      display: flex; align-items: center; gap: .5rem;
      z-index: 1;
      animation: logoBounce 2s infinite;
    }
    @keyframes logoBounce {
      0%,100% { transform: translateY(0); }
      50% { transform: translateY(-6px); }
    }
    header .logo img { height: 40px; }
    header .logo span {
      font-size: 1.6rem; font-weight: 700;
      text-shadow: 1px 1px 4px var(--shadow);
    }
    nav {
      display: flex; align-items: center; gap: 1.2rem;
      z-index: 1;
    }
    nav a {
      position: relative;
      text-decoration: none;
      color: var(--white);
      font-weight: 600;
      padding: .5rem;
      transition: color .3s;
      cursor: pointer;
    }
    nav a::after {
      content: '';
      position: absolute; left: 0; bottom: -4px;
      width: 0; height: 3px;
      background: var(--amber);
      transition: width .3s;
    }
    nav a:hover {
      color: var(--amber);
    }
    nav a:hover::after {
      width: 100%;
    }
    /* ===== HEADER SHAPES ===== */
    .shape-circle {
      position: absolute;
      border-radius: 50%;
      background: rgba(255,255,255,0.2);
      animation: floatSlow 10s infinite;
    }
    .shape-circle.one { width: 80px; height: 80px; top: -20px; right: 100px; }
    .shape-circle.two { width: 50px; height: 50px; bottom: 10px; left: 150px; animation-delay: 2s; }
    @keyframes floatSlow {
      0% { transform: translateY(0); }
      50% { transform: translateY(10px); }
      100% { transform: translateY(0); }
    }
    /* ===== HERO ===== */
    .hero {
      position: relative;
      height: 60vh;
      display: flex; align-items: center; justify-content: center;
      text-align: center;
      overflow: hidden;
    }
    .hero::before {
      content: '';
      position: absolute; inset: 0;
      background: url('fondo.png') center/cover no-repeat;
      filter: brightness(0.8);
    }
    .cloud {
      position: absolute;
      background: url('https://svgshare.com/i/XnN.svg') no-repeat center/contain;
      width: 200px; height: 80px;
      opacity: .7;
      animation: float  var(--anim-time) ease-in-out infinite;
    }
    .cloud:nth-child(1) { top: 20%; left: -10%; animation-delay: 0s; }
    .cloud:nth-child(2) { top: 40%; left: -15%; animation-delay: 1.5s; width: 150px; height: 60px; }
    .cloud:nth-child(3) { top: 10%; left: 100%; animation-delay: 3s; }
    @keyframes float {
      0%   { transform: translateX(0) translateY(0); }
      50%  { transform: translateX(120vw) translateY(10px); }
      100% { transform: translateX(0) translateY(0); }
    }
    .hero-content {
      position: relative; z-index: 10;
      color: var(--white);
      max-width: 800px; padding: 0 1rem;
      animation: fadeInUp 1s ease-out both;
    }
    .hero-content h1 {
      font-size: 3rem; margin-bottom: .5rem;
      text-shadow: 2px 2px 10px var(--shadow);
    }
    .hero-content p {
      font-size: 1.2rem; opacity: .9;
      animation: fadeInUp 1s ease-out .3s both;
    }
    @keyframes fadeInUp {
      from { opacity: 0; transform: translateY(20px); }
      to   { opacity: 1; transform: translateY(0); }
    }
    /* ===== MODULE CARDS ===== */
    main { padding: 4rem 1rem; max-width: 1200px; margin: 0 auto 4rem; }
    .modules { display: grid; grid-template-columns: repeat(auto-fit, minmax(260px,1fr)); gap: 2.5rem; }
    .card {
      position: relative; background: var(--white);
      border-radius: 20px; padding: 2rem 1rem 3rem;
      box-shadow: 0 8px 24px var(--shadow); overflow: hidden;
      transition: transform .3s, box-shadow .3s; cursor:pointer;
    }
    .card:hover { transform: translateY(-8px) scale(1.02); box-shadow:0 12px 32px var(--shadow);}    
    .card::before,.card::after { content:''; position:absolute; border-radius:50%; opacity:.15; }
    .card::before { width:200px;height:200px;top:-50px;right:-50px;background:var(--blue);transform:rotate(45deg);}    
    .card::after  { width:150px;height:150px;bottom:-40px;left:-60px;background:var(--grass);}    
    .card.vocab { background: var(--blue); color: var(--white);}    
    .card.grammar{ background: var(--amber); color: var(--text);}    
    .card.test   { background: var(--coral); color: var(--white);}    
    .card.sim    { background: var(--blue); color: var(--white);}
    .card.lesen { background: var(--grass); color: var(--white);}
    .card.redemittel { background: var(--coral); color: var(--white);}
    .card.quiz { background: var(--amber); color: var(--text);}
    .card .icon  { font-size:3.5rem;margin-bottom:1rem;transition:transform .3s;}    
    .card:hover .icon { transform:rotate(20deg) scale(1.1);}    
    .card h3     { font-size:1.6rem;margin-bottom:.6rem;text-shadow:1px 1px 4px var(--shadow);}    
    .card p      { font-size:1rem;margin-bottom:1.5rem;line-height:1.5; }    
    .card .btn   { display:inline-flex;align-items:center;gap:.5rem;background:var(--grass);color:var(--text);padding:.6rem 1.2rem;border:none;border-radius:12px;font-weight:700;box-shadow:0 4px 12px var(--shadow);transition:transform .3s,background .3s;}    
    .card .btn:hover { transform:translateY(-2px);background:var(--coral);color:var(--white);}    
    .card .btn .fa-arrow-right { transition:transform .3s; }    
    .card .btn:hover .fa-arrow-right { transform:translateX(4px);}    

    /* ===== HIDDEN SECTIONS ===== */
    .contenido-oculto { display: none; padding: 2rem; max-width: 900px; margin: 0 auto; }
    .contenido-oculto h2 { margin-bottom: 1rem; color: var(--blue); }
    .back-btn {
      margin-top: 2rem;
      display: inline-block;
      padding: .6rem 1.2rem;
      background: var(--coral);
      color: var(--white);
      border-radius: 10px;
      cursor: pointer;
      text-decoration: none;
      font-weight: 600;
    }
    .back-btn:hover { background: var(--blue); }

    /* ===== FLASHCARDS ===== */
    .flashcard-container {
      display: flex; flex-wrap: wrap; gap: 1rem; justify-content: center;
    }
    .flashcard {
      background: var(--white); border: 2px solid var(--blue);
      border-radius: 10px; width: 120px; height: 120px;
      display: flex; align-items: center; justify-content: center;
      cursor: pointer; position: relative; 
      transition: transform .3s;
    }
    .flashcard:hover { transform: scale(1.05); }
    .flashcard .word {
      position: absolute; bottom: 10px;
      font-size: 0.9rem; font-weight: bold;
      color: var(--text);
      display: none;
    }
    .flashcard.show .word { display: block; }
    .flashcard i {
      font-size: 2.5rem; color: var(--blue);
    }
    /* ===== DRAG & DROP ===== */
    .dnd-container { display: flex; flex-direction: column; align-items: center; gap: 1rem; }
    .dnd-zone, .dnd-source {
      display: flex; gap: 0.5rem; padding: 1rem;
    }
    .dnd-zone { min-height: 40px; border: 2px dashed var(--blue); padding: 1rem; width: 100%; }
    .dnd-zone.empty { opacity: 0.3; }
    .dnd-source .dnd-item, .dnd-zone .dnd-item {
      background: var(--white); border: 2px solid var(--coral);
      padding: 0.5rem 1rem; border-radius: 8px;
      cursor: grab;
    }

    /* ===== QUIZ ===== */
    .quiz-question { margin-bottom: 1rem; }
    .quiz-question p { margin-bottom: 0.5rem; }
    .quiz-options { list-style: none; padding: 0; }
    .quiz-options li { margin: 0.5rem 0; }
    .quiz-options li label { cursor: pointer; }
    .btn-submit {
      margin-top: 1rem; padding: 0.5rem 1rem;
      background: var(--blue); color: var(--white);
      border: none; border-radius: 8px; font-weight: 600; cursor: pointer;
    }
    .btn-submit:hover { background: var(--coral); }
    /* ===== EXAM ===== */
    .exam-section { margin-bottom: 2rem; }
    .exam-section h3 { font-size: 1.2rem; margin-bottom: 0.5rem; }
    .result { font-size: 1.2rem; font-weight: bold; margin-top: 1rem; }
    .hidden { display: none; }
  </style>
</head>
<body>
  <header>
    <div class="shape-circle one"></div>
    <div class="shape-circle two"></div>
    <div class="logo">
      <img src="header.png" alt="üá©üá™" />
      <span>HalloGenios</span>
    </div>
    <nav>
      <a onclick="mostrarSeccion('home')">Startseite</a>
      <a onclick="mostrarSeccion('vokabeln')">Vokabeln</a>
      <a onclick="mostrarSeccion('grammatik')">Grammatik</a>
      <a onclick="mostrarSeccion('lesen')">Leseverstehen</a>
      <a onclick="mostrarSeccion('redemittel')">Redemittel</a>
      <a onclick="mostrarSeccion('quiz')">Quiz-Modus</a>
      <a onclick="mostrarSeccion('simulation')">Simulationspr√ºfung</a>
    </nav>
  </header>

  <!-- HOME -->
  <section id="home">
    <div class="hero">
      <div class="cloud"></div>
      <div class="cloud"></div>
      <div class="cloud"></div>
      <div class="hero-content">
        <h1>Herzlich willkommen auf unserer Webseite!</h1>
        <p>Diese Seite ist f√ºr Sch√ºler gedacht, die sich spielerisch auf die A2-Pr√ºfung in Deutsch vorbereiten m√∂chten. Hier kannst du neues Vokabular mit Bildern lernen, dein Ged√§chtnis trainieren und mit √úbungstests dein Wissen testen. Viel Spa√ü beim Lernen!</p>
      </div>
    </div>
    <main>
      <div class="modules">
        <div class="card vocab" onclick="mostrarSeccion('vokabeln')">
          <i class="fa-solid fa-language icon"></i>
          <h3>Vokabeln lernen</h3>
          <p>Entdecke neue W√∂rter mit bunten Bildern und Spielen.</p>
          <button class="btn">Los geht‚Äôs <i class="fa-solid fa-arrow-right"></i></button>
        </div>
        <div class="card grammar" onclick="mostrarSeccion('grammatik')">
          <i class="fa-solid fa-book-open icon"></i>
          <h3>Grammatik √ºben</h3>
          <p>Lerne Zeiten, F√§lle und Pr√§positionen durch interaktive R√§tsel.</p>
          <button class="btn">Los geht‚Äôs <i class="fa-solid fa-arrow-right"></i></button>
        </div>
        <div class="card lesen" onclick="mostrarSeccion('lesen')">
          <i class="fa-solid fa-book icon"></i>
          <h3>Leseverstehen</h3>
          <p>Verbessere dein Textverst√§ndnis mit Kurzgeschichten und Fragen.</p>
          <button class="btn">Los geht‚Äôs <i class="fa-solid fa-arrow-right"></i></button>
        </div>
        <div class="card redemittel" onclick="mostrarSeccion('redemittel')">
          <i class="fa-solid fa-comment-dots icon"></i>
          <h3>Redemittel</h3>
          <p>Lerne n√ºtzliche Ausdr√ºcke f√ºr Alltag und Pr√ºfungen.</p>
          <button class="btn">Los geht‚Äôs <i class="fa-solid fa-arrow-right"></i></button>
        </div>
        <div class="card quiz" onclick="mostrarSeccion('quiz')">
          <i class="fa-solid fa-gamepad icon"></i>
          <h3>Quiz-Modus</h3>
          <p>Teste dein Wissen spielerisch mit unterhaltsamen Quiz.</p>
          <button class="btn">Los geht‚Äôs <i class="fa-solid fa-arrow-right"></i></button>
        </div>
        <div class="card test" onclick="mostrarSeccion('simulation')">
          <i class="fa-solid fa-clipboard-list icon"></i>
          <h3>Simulationspr√ºfung</h3>
          <p>Erlebe das Pr√ºfungsgef√ºhl im realistischen Testmodus unter Zeitdruck.</p>
          <button class="btn">Los geht‚Äôs <i class="fa-solid fa-arrow-right"></i></button>
        </div>
      </div>
    </main>
  </section>

  <!-- VOCABULARY FLASHCARDS -->
  <section id="vokabeln" class="contenido-oculto">
    <h2>Vokabeln lernen</h2>
    <p>Lerne 200 wichtige W√∂rter mit unseren interaktiven Flashcards!</p>
    <div class="flashcard-container">
      <div class="flashcard" onclick="this.classList.toggle('show')">
        <i class="fa-solid fa-house"></i>
        <span class="word">das Haus</span>
      </div>
      <div class="flashcard" onclick="this.classList.toggle('show')">
        <i class="fa-solid fa-car"></i>
        <span class="word">das Auto</span>
      </div>
      <div class="flashcard" onclick="this.classList.toggle('show')">
        <i class="fa-solid fa-bus"></i>
        <span class="word">der Bus</span>
      </div>
      <div class="flashcard" onclick="this.classList.toggle('show')">
        <i class="fa-solid fa-shop"></i>
        <span class="word">der Supermarkt</span>
      </div>
      <div class="flashcard" onclick="this.classList.toggle('show')">
        <i class="fa-solid fa-utensils"></i>
        <span class="word">das Essen</span>
      </div>
      <div class="flashcard" onclick="this.classList.toggle('show')">
        <i class="fa-solid fa-film"></i>
        <span class="word">der Film</span>
      </div>
      <div class="flashcard" onclick="this.classList.toggle('show')">
        <i class="fa-solid fa-dog"></i>
        <span class="word">der Hund</span>
      </div>
      <div class="flashcard" onclick="this.classList.toggle('show')">
        <i class="fa-solid fa-book-open"></i>
        <span class="word">das Buch</span>
      </div>
    </div>
    <p>Tipp: Klicke auf eine Karte, um das Wort anzuzeigen oder zu verbergen.</p>
    <span class="back-btn" onclick="mostrarSeccion('home')">Zur√ºck</span>
  </section>

<!-- GRAMMATIK √úBEN (EXTENDIDO) -->
<section id="grammatik" class="contenido-oculto">
  <style>
    /* ===== Estilos locales para esta secci√≥n ===== */
    .hint {
      background: rgba(255,255,255,.8);
      border-left: 5px solid var(--blue);
      padding: .8rem 1rem; border-radius: 8px; margin: .6rem 0 1rem;
      font-size: .95rem;
    }
    .exo { margin: 1.2rem 0 2rem; }
    .exo h3 { display: flex; align-items: center; gap: .6rem; }
    .exo h3 i { opacity: .8; }

    /* DnD / Tap-to-build */
    .dnd-app { display:flex; flex-direction:column; gap: .75rem; }
    .dnd-status { display:flex; justify-content:space-between; align-items:center; gap:.5rem; font-size:.95rem; }
    .dnd-target, .dnd-source {
      display:flex; flex-wrap:wrap; gap:.5rem; padding: .8rem;
      min-height: 52px; border:2px dashed var(--blue); border-radius: 10px; background: rgba(255,255,255,.7);
    }
    .dnd-target { border-style: solid; }
    .chip {
      display:inline-flex; align-items:center; gap:.35rem;
      padding:.5rem .7rem; border-radius: 999px;
      background: var(--white); border:2px solid var(--coral);
      font-weight:600; cursor: pointer; user-select:none;
      transition: transform .12s ease-in-out;
    }
    .chip:active { transform: scale(.96); }
    .chip[draggable="true"] { cursor: grab; }
    .dnd-controls { display:flex; flex-wrap:wrap; gap:.6rem; }
    .btn-ghost {
      padding:.45rem .8rem; border-radius: 8px; border:2px solid var(--blue);
      background: transparent; font-weight:600; cursor:pointer;
    }
    .ok { color:#1a7f37; }
    .bad { color:#b1002e; }

    /* Multiple choice */
    .mc-card { background: rgba(255,255,255,.8); border-radius:12px; padding: .9rem; margin:.7rem 0; box-shadow:0 2px 8px var(--shadow); }
    .mc-q { margin-bottom:.4rem; }
    .mc-opts { list-style:none; padding:0; margin:0; }
    .mc-opts li { margin:.35rem 0; }
    .mc-controls { display:flex; align-items:center; gap:.8rem; flex-wrap:wrap; margin-top:.6rem; }

    /* Fill-in + Nube de palabras */
    .fill-item { background: rgba(255,255,255,.85); padding:.9rem; border-radius:12px; box-shadow:0 2px 8px var(--shadow); margin:.6rem 0; }
    .fill-item input {
      min-width: 120px; max-width: 160px; padding:.45rem .6rem; border-radius: 8px;
      border:2px solid var(--blue); outline:none; font-weight:700; text-align:center;
    }
    .word-bank { display:flex; flex-wrap:wrap; gap:.45rem; margin-top:.8rem; }
    .bank-chip { background:#fff; border:2px solid var(--grass); border-radius:999px; padding:.35rem .6rem; font-weight:700; cursor:pointer; }

    /* Modal de glosario */
    .modal { position: fixed; inset:0; display:flex; align-items:center; justify-content:center; background:rgba(0,0,0,.45); z-index:9999; }
    .modal.hidden { display:none; }
    .modal-content {
      background:#fff; border-radius:12px; padding:1rem 1.2rem; max-width: 420px; width: calc(100% - 2rem);
      box-shadow:0 10px 30px rgba(0,0,0,.25);
    }
    .modal-content h4 { margin-bottom:.4rem; color:var(--blue); }
    .modal-close { float:right; border:none; background:transparent; font-size:1.4rem; cursor:pointer; }

    /* Palabras dif√≠ciles (clic para ver significado) */
    .gloss { border-bottom: 2px dotted var(--coral); background: rgba(212,90,86,.08); border-radius:6px; padding:0 .2rem; cursor:pointer; }

    /* M√≥vil */
    @media (max-width: 600px){
      .dnd-target, .dnd-source { min-height: 64px; }
      .chip { padding:.6rem .8rem; }
      .fill-item input { min-width: 90px; max-width: 120px; }
    }
  </style>

  <h2>Gram√°tica interactiva</h2>
  <p class="hint">
    üëã Bienvenido/a. Aqu√≠ reforzar√°s estructuras b√°sicas de alem√°n (<strong>A1/A2</strong>) usando ejercicios cortos y visuales.
    Todo est√° pensado para celular, tablet y computador. Si <em>arrastrar y soltar</em> no funciona en tu m√≥vil,
    simplemente <strong>toca</strong> las palabras para construir la frase. Las <span class="gloss" data-term="palabras dif√≠ciles">palabras dif√≠ciles</span>
    aparecen subrayadas: t√≥calas para ver su significado en espa√±ol.
  </p>

  <!-- 1) DnD / Tap-to-build -->
  <article class="exo exo-dnd">
    <h3><i class="fa-solid fa-hand-pointer"></i> 1. Ordena la frase (Drag & Drop o toque)</h3>
    <p>Forma la oraci√≥n en alem√°n a partir de las palabras desordenadas. Consejo: observa la posici√≥n del verbo y los elementos del tiempo/lugar.</p>

    <div id="dnd-app" class="dnd-app" aria-live="polite">
      <div class="dnd-status">
        <span id="dnd-progress">1 / 20</span>
        <div>
          <button id="dnd-reset" class="btn-ghost" type="button"><i class="fa-solid fa-rotate-left"></i> Reiniciar</button>
          <button id="dnd-solution" class="btn-ghost" type="button"><i class="fa-solid fa-lightbulb"></i> Ver soluci√≥n</button>
        </div>
      </div>
      <div class="dnd-target" id="dnd-target" aria-label="Tu frase" role="list"></div>
      <div class="dnd-source" id="dnd-source" aria-label="Palabras disponibles" role="list"></div>
      <div class="dnd-controls">
        <button id="dnd-check" class="btn-submit" type="button">Comprobar</button>
        <button id="dnd-prev" class="btn-ghost" type="button">‚üµ Anterior</button>
        <button id="dnd-next" class="btn-ghost" type="button">Siguiente ‚ü∂</button>
      </div>
      <p id="dnd-feedback"></p>
    </div>
  </article>

  <!-- 2) Multiple choice -->
  <article class="exo exo-mc">
    <h3><i class="fa-solid fa-list-check"></i> 2. Opci√≥n m√∫ltiple (elige la forma correcta)</h3>
    <p>Selecciona la opci√≥n correcta para completar la frase. Enf√≥cate en <strong>art√≠culos</strong>, <strong>casos</strong> y <strong>formas verbales</strong>.</p>

    <div id="mc-app">
      <div id="mc-questions"></div>
      <div class="mc-controls">
        <button id="mc-check" class="btn-submit" type="button">Comprobar todo</button>
        <button id="mc-reset" class="btn-ghost" type="button">Reiniciar</button>
        <p id="mc-score" class="result"></p>
      </div>
    </div>
  </article>

  <!-- 3) Llenado de huecos + Nube de palabras -->
  <article class="exo exo-fill">
    <h3><i class="fa-solid fa-pen-to-square"></i> 3. Llenado de huecos (con banco de palabras)</h3>
    <p>Completa las oraciones con la opci√≥n correcta. Puedes escribir directamente o tocar una palabra del <strong>banco</strong> para insertarla.</p>
    <div id="fill-app">
      <div id="fill-questions"></div>
      <div>
        <h4 style="margin-top:.8rem;">Banco de palabras</h4>
        <div class="word-bank" id="word-bank"></div>
      </div>
      <div class="mc-controls">
        <button id="fill-check" class="btn-submit" type="button">Comprobar todo</button>
        <button id="fill-reset" class="btn-ghost" type="button">Reiniciar</button>
        <p id="fill-score" class="result"></p>
      </div>
    </div>
  </article>

  <span class="back-btn" onclick="mostrarSeccion('home')">Volver al inicio</span>

  <!-- Modal Glosario -->
  <div id="gloss-modal" class="modal hidden" role="dialog" aria-modal="true" aria-labelledby="gloss-term" aria-describedby="gloss-def">
    <div class="modal-content">
      <button class="modal-close" id="gloss-close" aria-label="Cerrar">√ó</button>
      <h4 id="gloss-term">T√©rmino</h4>
      <p id="gloss-def">Definici√≥n en espa√±ol.</p>
    </div>
  </div>

  <script>
  (function(){
    /* ======== Datos (Banco de ejercicios) ======== */
    const DND_ITEMS = [
      { parts:["ich","fr√ºh","auf","stehe"], answer:"Ich stehe fr√ºh auf." },
      { parts:["wir","mit dem Bus","zur Schule","fahren"], answer:"Wir fahren mit dem Bus zur Schule." },
      { parts:["meine Schwester","gern","liest","B√ºcher"], answer:"Meine Schwester liest gern B√ºcher." },
      { parts:["wann","triffst","du","Freunde"], answer:"Wann triffst du Freunde?" },
      { parts:["er","jeden Tag","kocht","das Abendessen"], answer:"Er kocht jeden Tag das Abendessen." },
      { parts:["spielen","die Kinder","im Park"], answer:"Die Kinder spielen im Park." },
      { parts:["ich","einkaufen","im Supermarkt","gehe"], answer:"Ich gehe im Supermarkt einkaufen." },
      { parts:["wir","heute Abend","bestellen","eine Pizza"], answer:"Wir bestellen heute Abend eine Pizza." },
      { parts:["wann","kommt","der Zug"], answer:"Wann kommt der Zug?" },
      { parts:["meine Eltern","im Krankenhaus","arbeiten","beide"], answer:"Meine Eltern arbeiten beide im Krankenhaus." },
      { parts:["wie lange","lernst","du","Deutsch"], answer:"Wie lange lernst du Deutsch?" },
      { parts:["sie","auf dem Land","wohnt"], answer:"Sie wohnt auf dem Land." },
      { parts:["wir","morgen","keine Schule","haben"], answer:"Wir haben morgen keine Schule." },
      { parts:["machst","du","nach dem Essen","die Hausaufgaben"], answer:"Machst du nach dem Essen die Hausaufgaben?" },
      { parts:["er","mit dem Fahrrad","zur Arbeit","f√§hrt"], answer:"Er f√§hrt mit dem Fahrrad zur Arbeit." },
      { parts:["die Lehrerin","erkl√§rt","die Aufgabe","langsam"], answer:"Die Lehrerin erkl√§rt die Aufgabe langsam." },
      { parts:["wen","besuchen","wir","am Sonntag"], answer:"Wen besuchen wir am Sonntag?" },
      { parts:["ich","ein Ticket","am Schalter","kaufe"], answer:"Ich kaufe ein Ticket am Schalter." },
      { parts:["die Bahn","heute","hat","Versp√§tung"], answer:"Die Bahn hat heute Versp√§tung." },
      { parts:["h√∂rst","du","nach der Schule","Musik"], answer:"H√∂rst du nach der Schule Musik?" }
    ];

    const MC_ITEMS = [
      { q:"Ich ___ ein Buch.", opts:["lesen","lese","liest"], ans:1 },
      { q:"Wir ___ gestern keine Zeit.", opts:["hatten","hat","haben"], ans:0 },
      { q:"___ Bruder studiert in Berlin.", opts:["Mein","Meine","Meinen"], ans:0 },
      { q:"Ich fahre morgen ___ Bus zur Schule.", opts:["mit dem","mit den","mit der"], ans:0 },
      { q:"Sie ___ sehr m√ºde.", opts:["ist","sind","seid"], ans:0 },
      { q:"Gestern ___ es sehr kalt.", opts:["war","ist","waren"], ans:0 },
      { q:"Ich nehme ___ Apfel.", opts:["der","den","dem"], ans:1 },
      { q:"Wir treffen ___ Freunde im Park.", opts:["unsere","unseren","unserem"], ans:0 },
      { q:"Er hat ___ Hausaufgaben gemacht.", opts:["sein","seine","seinen"], ans:1 },
      { q:"Ich gehe heute ___ Stadt.", opts:["in die","in der","in den"], ans:0 },
      { q:"Das ist die Tasche ___ Schwester.", opts:["meines","meiner","meinem"], ans:1 },
      { q:"Ich wohne seit zwei Jahren ___ K√∂ln.", opts:["in","nach","zu"], ans:0 },
      { q:"K√∂nnen Sie mir ___ helfen?", opts:["bitte","bittet","gebeten"], ans:0 },
      { q:"Er ___ gestern krank.", opts:["ist","war","hatte"], ans:1 },
      { q:"Ich habe heute keine ___.", opts:["Zeit","Zeite","Zeiten"], ans:0 },
      { q:"Wie sp√§t ___ es?", opts:["sind","ist","war"], ans:1 },
      { q:"Wir warten ___ den Bus.", opts:["auf","an","mit"], ans:0 },
      { q:"Ich trinke lieber ___ Wasser als Cola.", opts:["ein","√ò","der"], ans:1 },
      { q:"Sie hat ___ neue Schuhe gekauft.", opts:["ein","eine","√ò"], ans:1 },
      { q:"Der Zug ___ um 7:30 Uhr ab.", opts:["f√§hrt","fahrt","fuhr"], ans:0 }
    ];

    const FILL_ITEMS = [
      { q:"Ich ___ 12 Jahre alt.", ans:"bin" },
      { q:"Wir ___ am Samstag frei.", ans:"haben" },
      { q:"Gestern ___ ich krank.", ans:"war" },
      { q:"Meine Mutter ___ im Krankenhaus.", ans:"arbeitet" },
      { q:"Ich ___ jeden Morgen Kaffee.", ans:"trinke" },
      { q:"Er ___ mit dem Fahrrad zur Schule.", ans:"f√§hrt" },
      { q:"Wir ___ die Gro√üeltern am Sonntag.", ans:"besuchen" },
      { q:"Ich ___ kein Geld dabei.", ans:"habe" },
      { q:"Wo ___ du? In K√∂ln.", ans:"wohnst" },
      { q:"Sie ___ sehr gut Deutsch.", ans:"spricht" },
      { q:"Im Sommer ___ wir oft im See.", ans:"baden" },
      { q:"Gestern ___ wir keine Hausaufgaben.", ans:"hatten" },
      { q:"Ich ___ heute fr√ºh auf.", ans:"stehe" },
      { q:"Sie ___ Brot und Milch.", ans:"kauft" },
      { q:"Wir ___ um 7 Uhr in der Schule.", ans:"sind" },
      { q:"Der Film ___ um 18:30 Uhr.", ans:"beginnt" },
      { q:"Ich ___ gern Fu√üball.", ans:"spiele" },
      { q:"Heute ___ es warm.", ans:"ist" },
      { q:"Entschuldigung, ich ___ eine Frage.", ans:"habe" },
      { q:"Meine Freunde ___ morgen nach Berlin.", ans:"fahren" }
    ];
    const WORD_BANK = [...new Set(FILL_ITEMS.map(x => x.ans))];

    /* ======== Glosario (palabras dif√≠ciles) ======== */
    const GLOSS = {
      "Versp√§tung":"demora, retraso (p.ej., del tren).",
      "Schalter":"ventanilla/taquilla (punto de atenci√≥n para comprar tickets).",
      "beide":"ambos/ambas.",
      "wann":"¬øcu√°ndo?",
      "wie lange":"¬øcu√°nto tiempo?",
      "bestellen":"pedir/ordenar (comida, producto).",
      "erkl√§rt":"explica.",
      "Aufgabe":"tarea/ejercicio.",
      "besuchen":"visitar.",
      "beginnt":"empieza, comienza.",
      "wohnt":"vive (reside).",
      "f√§hrt":"va/conduce (en veh√≠culo).",
      "seit":"desde (hace).",
      "gebeten":"(participio de) pedir/rogar (no se usa aqu√≠ como opci√≥n correcta)."
    };

    /* ======== Utilidades ======== */
    const byId = id => document.getElementById(id);
    const norm = s => s.toLowerCase().replaceAll(/[.,!?¬ø¬°]/g,'').trim();
    function shuffle(arr){ return arr.map(v=>[Math.random(),v]).sort((a,b)=>a[0]-b[0]).map(x=>x[1]); }

    /* ======== 1) DnD / Tap-to-build ======== */
    const dnd = {
      idx: 0,
      init(){
        this.target = byId('dnd-target');
        this.source = byId('dnd-source');
        this.progress = byId('dnd-progress');
        this.feedback = byId('dnd-feedback');
        byId('dnd-check').addEventListener('click', ()=>this.check());
        byId('dnd-prev').addEventListener('click', ()=>this.move(-1));
        byId('dnd-next').addEventListener('click', ()=>this.move(1));
        byId('dnd-reset').addEventListener('click', ()=>this.load(this.idx));
        byId('dnd-solution').addEventListener('click', ()=>this.showSolution());
        this.load(0);
      },
      move(delta){
        this.idx = (this.idx + delta + DND_ITEMS.length) % DND_ITEMS.length;
        this.load(this.idx);
      },
      makeChip(text){
        const btn = document.createElement('button');
        btn.className = 'chip';
        btn.type = 'button';
        btn.textContent = text;
        btn.setAttribute('draggable','true');
        btn.addEventListener('dragstart', e=> e.dataTransfer.setData('text/plain', text));
        // Tap-to-move
        btn.addEventListener('click', ()=>{
          if (btn.parentElement === this.source) {
            this.target.appendChild(btn);
          } else {
            this.source.appendChild(btn);
          }
        });
        // Glosario si aplica
        const t = text.trim();
        const key = Object.keys(GLOSS).find(k => k.toLowerCase() === t.toLowerCase());
        if (key){
          btn.classList.add('gloss');
          btn.addEventListener('click', (ev)=>{
            // Evitar que el movimiento tape el gloss: si Ctrl o Alt, solo gloss
            if (!ev.ctrlKey && !ev.altKey) showGloss(key); 
          }, {capture:true});
        }
        return btn;
      },
      setupDnDZones(){
        const onOver = e=>{ e.preventDefault(); };
        const onDropTo = (toEl) => (e)=>{
          e.preventDefault();
          const text = e.dataTransfer.getData('text/plain');
          // Buscar chip en source con ese texto (si hay repetidos, toma el primero visible)
          const chip = [...this.source.querySelectorAll('.chip')].find(c => c.textContent === text);
          if (chip) toEl.appendChild(chip);
        };
        this.target.addEventListener('dragover', onOver);
        this.source.addEventListener('dragover', onOver);
        this.target.addEventListener('drop', onDropTo(this.target));
        this.source.addEventListener('drop', onDropTo(this.source));
      },
      load(i){
        const item = DND_ITEMS[i];
        this.feedback.textContent = '';
        this.progress.textContent = (i+1) + ' / ' + DND_ITEMS.length;

        // limpiar
        this.target.innerHTML = '';
        this.source.innerHTML = '';

        // rellenar source con orden aleatorio
        const parts = shuffle(item.parts.slice());
        parts.forEach(p => this.source.appendChild(this.makeChip(p)));

        // Asegurar listeners DnD
        this.setupDnDZones();
      },
      currentSentence(){
        return [...this.target.querySelectorAll('.chip')].map(c=>c.textContent).join(' ');
      },
      check(){
        const item = DND_ITEMS[this.idx];
        const got = norm(this.currentSentence());
        const expected = norm(item.answer);
        if (!got) {
          this.feedback.textContent = 'Primero arma tu oraci√≥n tocando/arrastrando las palabras.';
          this.feedback.className = 'bad';
          return;
        }
        if (got === expected){
          this.feedback.textContent = '¬°Correcto! üéâ';
          this.feedback.className = 'ok';
        } else {
          this.feedback.textContent = 'A√∫n no. Revisa posici√≥n del verbo y complementos.';
          this.feedback.className = 'bad';
        }
      },
      showSolution(){
        const item = DND_ITEMS[this.idx];
        this.target.innerHTML = '';
        this.source.innerHTML = '';
        item.parts.forEach(p => this.target.appendChild(this.makeChip(p)));
        this.feedback.textContent = 'Soluci√≥n mostrada.';
        this.feedback.className = 'ok';
      }
    };

    /* ======== 2) Multiple choice ======== */
    const mc = {
      init(){
        this.wrap = byId('mc-questions');
        this.score = byId('mc-score');
        byId('mc-check').addEventListener('click', ()=>this.checkAll());
        byId('mc-reset').addEventListener('click', ()=>this.render());
        this.render();
      },
      render(){
        this.score.textContent = '';
        this.wrap.innerHTML = '';
        MC_ITEMS.forEach((it, idx)=>{
          const card = document.createElement('div'); card.className='mc-card';
          const q = document.createElement('div'); q.className='mc-q';
          // Realzar palabras dif√≠ciles en el enunciado
          let qText = it.q;
          qText = qText
            .replace('seit', '<span class="gloss" data-term="seit">seit</span>');
          q.innerHTML = `<strong>${idx+1}.</strong> ${qText}`;
          const ul = document.createElement('ul'); ul.className='mc-opts';
          it.opts.forEach((opt,oIdx)=>{
            // marcar opciones con t√©rminos dif√≠ciles
            let showOpt = opt;
            if (GLOSS[opt]) showOpt = `<span class="gloss" data-term="${opt}">${opt}</span>`;
            const id = `mc_${idx}_${oIdx}`;
            const li = document.createElement('li');
            li.innerHTML = `
              <label for="${id}">
                <input type="radio" id="${id}" name="mc_${idx}" value="${oIdx}">
                ${String.fromCharCode(97+oIdx)}) ${showOpt}
              </label>`;
            ul.appendChild(li);
          });
          const feedback = document.createElement('p'); feedback.id = `mc_fb_${idx}`;
          card.appendChild(q); card.appendChild(ul); card.appendChild(feedback);
          this.wrap.appendChild(card);
        });
        // activar glosario en los spans a√±adidos
        this.wrap.querySelectorAll('.gloss').forEach(el=>{
          el.addEventListener('click', ()=> showGloss(el.dataset.term));
        });
      },
      checkAll(){
        let correct=0;
        MC_ITEMS.forEach((it, idx)=>{
          const chosen = document.querySelector(`input[name="mc_${idx}"]:checked`);
          const fb = byId(`mc_fb_${idx}`);
          if(!chosen){
            fb.textContent='Elige una opci√≥n.'; fb.className='bad';
            return;
          }
          if (parseInt(chosen.value,10) === it.ans){
            fb.textContent='¬°Correcto!'; fb.className='ok'; correct++;
          } else {
            fb.textContent=`Incorrecto. Respuesta: ${String.fromCharCode(97+it.ans)}) ${it.opts[it.ans]}`; fb.className='bad';
          }
        });
        this.score.textContent = `Puntaje: ${correct} / ${MC_ITEMS.length}`;
      }
    };

    /* ======== 3) Fill-in + Banco de palabras ======== */
    const fill = {
      init(){
        this.wrap = byId('fill-questions');
        this.bank = byId('word-bank');
        this.score = byId('fill-score');
        byId('fill-check').addEventListener('click', ()=>this.checkAll());
        byId('fill-reset').addEventListener('click', ()=>this.render());
        this.render();
      },
      render(){
        this.score.textContent = '';
        this.wrap.innerHTML = '';
        // Render preguntas
        FILL_ITEMS.forEach((it, idx)=>{
          const box = document.createElement('div'); box.className='fill-item';
          // Resaltar palabras dif√≠ciles en el enunciado
          let qText = it.q
            .replace('f√§hrt','<span class="gloss" data-term="f√§hrt">f√§hrt</span>')
            .replace('wo','<span class="gloss" data-term="wann">wo</span>') // nota: usamos gloss de 'wann' solo para ejemplo "interrogativos"
            .replace('beginnt','<span class="gloss" data-term="beginnt">beginnt</span>')
            .replace('wohne','<span class="gloss" data-term="wohnt">wohne</span>') // aproximaci√≥n
            .replace('wohns','<span class="gloss" data-term="wohnt">wohns</span>');
          box.innerHTML = `
            <label for="fill_${idx}"><strong>${idx+1}.</strong> ${qText}</label>
            <div style="margin-top:.4rem;">
              <input inputmode="latin" autocomplete="off" autocapitalize="off" spellcheck="false" id="fill_${idx}" placeholder="Escribe o toca del banco ‚Üí">
              <span id="fill_fb_${idx}"></span>
            </div>
          `;
          this.wrap.appendChild(box);
        });
        // Glosario en enunciados
        this.wrap.querySelectorAll('.gloss').forEach(el=>{
          el.addEventListener('click', ()=> showGloss(el.dataset.term));
        });
        // Banco de palabras
        this.bank.innerHTML = '';
        WORD_BANK.forEach(w=>{
          const chip = document.createElement('button');
          chip.type='button'; chip.className='bank-chip'; chip.textContent = w;
          chip.addEventListener('click', ()=>{
            // insertar en input enfocado o el primero vac√≠o
            const focused = document.activeElement && document.activeElement.tagName==='INPUT' && document.activeElement.id.startsWith('fill_')
              ? document.activeElement
              : [...this.wrap.querySelectorAll('input')].find(i=>!i.value);
            if (focused) {
              focused.value = w;
              focused.focus();
            }
          });
          this.bank.appendChild(chip);
        });
      },
      checkAll(){
        let correct=0;
        FILL_ITEMS.forEach((it, idx)=>{
          const input = byId(`fill_${idx}`);
          const fb = byId(`fill_fb_${idx}`);
          const val = (input.value || '').trim().toLowerCase();
          if (!val){ fb.textContent=' ‚ö†Ô∏è'; fb.className='bad'; fb.style.marginLeft='.4rem'; return; }
          if (val === it.ans.toLowerCase()){
            fb.textContent=' ‚úî'; fb.className='ok'; fb.style.marginLeft='.4rem'; correct++;
          } else {
            fb.textContent=` ‚úñ (${it.ans})`; fb.className='bad'; fb.style.marginLeft='.4rem';
          }
        });
        this.score.textContent = `Puntaje: ${correct} / ${FILL_ITEMS.length}`;
      }
    };

    /* ======== Modal glosario ======== */
    const modal = byId('gloss-modal'), termEl = byId('gloss-term'), defEl = byId('gloss-def');
    byId('gloss-close').addEventListener('click', ()=> modal.classList.add('hidden'));
    function showGloss(term){
      const key = Object.keys(GLOSS).find(k => k.toLowerCase() === term.toLowerCase());
      termEl.textContent = key || term;
      defEl.textContent = GLOSS[key] || 'Sin definici√≥n registrada.';
      modal.classList.remove('hidden');
    }

    /* ======== Inicializar cuando el DOM est√© listo ======== */
    function initAll(){
      // Activar glosario en el texto introductorio
      document.querySelectorAll('#grammatik .gloss').forEach(el=>{
        if (el.dataset.term) el.addEventListener('click', ()=> showGloss(el.dataset.term));
      });
      dnd.init(); mc.init(); fill.init();
    }
    if (document.readyState !== 'loading') initAll();
    else document.addEventListener('DOMContentLoaded', initAll);
  })();
  </script>
</section>


<!-- LESEVERSTEHEN (EXTENDIDO) -->
<section id="lesen" class="contenido-oculto">
  <style>
    /* ===== Estilos locales para Comprensi√≥n Lectora ===== */
    .hint {
      background: rgba(255,255,255,.85);
      border-left: 5px solid var(--blue);
      padding: .9rem 1rem; border-radius: 10px; margin: .6rem 0 1rem;
      font-size: .95rem;
    }
    .lesen-wrap { display:flex; flex-direction:column; gap:1rem; }
    .tabs { display:flex; gap:.6rem; flex-wrap:wrap; }
    .tab-btn {
      border:2px solid var(--blue); background:#fff; color:var(--text);
      padding:.5rem .8rem; border-radius: 999px; cursor:pointer; font-weight:700;
    }
    .tab-btn.active { background: var(--blue); color: #fff; }
    .card-lesen {
      background: rgba(255,255,255,.9); border-radius: 12px; padding: 1rem;
      box-shadow: 0 4px 16px var(--shadow);
    }
    .title-row { display:flex; align-items:center; gap:.6rem; margin-bottom:.4rem; }
    .mini-text { font-size:1rem; line-height:1.55; margin:.4rem 0 .8rem; }
    .q-block { margin:.6rem 0; }
    .opts { list-style:none; margin:.3rem 0 0; padding:0; }
    .opts li { margin:.3rem 0; }
    .opts label { display:flex; align-items:center; gap:.5rem; cursor:pointer; }
    .controls { display:flex; flex-wrap:wrap; gap:.6rem; align-items:center; margin-top:.6rem; }
    .score { font-weight:700; }
    .ok { color:#1a7f37; }
    .bad { color:#b1002e; }
    .muted { opacity:.85; }

    /* Modal glosario local (ID √∫nico para esta secci√≥n) */
    .modal-lesen { position:fixed; inset:0; display:flex; align-items:center; justify-content:center;
      background: rgba(0,0,0,.45); z-index: 9999; }
    .modal-lesen.hidden { display:none; }
    .modal-box {
      background:#fff; border-radius:12px; padding:1rem 1.2rem; width:min(460px, calc(100% - 2rem));
      box-shadow:0 12px 28px rgba(0,0,0,.35);
    }
    .modal-box h4 { margin:0 0 .3rem; color:var(--blue); }
    .modal-close { float:right; border:none; background:transparent; font-size:1.4rem; cursor:pointer; }

    /* Palabras dif√≠ciles clicables */
    .gloss { border-bottom:2px dotted var(--coral); background: rgba(212,90,86,.08); border-radius:6px; padding:0 .2rem; cursor:pointer; }

    /* Responsivo m√≥vil */
    @media (max-width:600px){
      .card-lesen { padding:.9rem; }
      .opts li { margin:.25rem 0; }
    }
  </style>

  <h2>Comprensi√≥n lectora ‚Äì Lesen und Verstehen</h2>
  <p class="hint">
    üìñ En esta secci√≥n practicar√°s con <strong>textos muy cortos</strong> (correos, avisos, mensajes) como en el nivel <strong>A1/A2</strong>.  
    Lee con calma y responde. Funciona en celular, tablet y computador.  
    Las <span class="gloss" data-term="palabras dif√≠ciles">palabras dif√≠ciles</span> aparecen subrayadas: t√≥calas para ver el significado en espa√±ol.
  </p>

  <div class="lesen-wrap">
    <div class="tabs" role="tablist">
      <button class="tab-btn active" id="tab-mini" type="button"><i class="fa-solid fa-envelope-open-text"></i> Mini-textos</button>
      <button class="tab-btn" id="tab-vf" type="button"><i class="fa-solid fa-check-double"></i> Verdadero/Falso</button>
    </div>

    <!-- MINI-TEXTOS -->
    <div id="mini-panel" class="card-lesen" role="tabpanel" aria-labelledby="tab-mini">
      <div class="title-row">
        <i id="mini-icon" class="fa-solid fa-envelope"></i>
        <strong id="mini-tipo">[Correo escolar]</strong>
        <span class="muted" id="mini-progress">1 / 15</span>
      </div>
      <div id="mini-text" class="mini-text"></div>
      <div class="q-block">
        <div id="mini-q1" class="mc-row"></div>
        <ul id="mini-opts1" class="opts"></ul>
        <p id="mini-fb1"></p>
      </div>
      <div class="q-block">
        <div id="mini-q2" class="mc-row"></div>
        <ul id="mini-opts2" class="opts"></ul>
        <p id="mini-fb2"></p>
      </div>
      <div class="controls">
        <button class="btn-submit" id="mini-check" type="button">Comprobar</button>
        <button class="btn-ghost" id="mini-prev" type="button">‚üµ Anterior</button>
        <button class="btn-ghost" id="mini-next" type="button">Siguiente ‚ü∂</button>
        <button class="btn-ghost" id="mini-reset" type="button"><i class="fa-solid fa-rotate-left"></i> Reiniciar</button>
        <span id="mini-score" class="score"></span>
      </div>
    </div>

    <!-- VERDADERO/FALSO -->
    <div id="vf-panel" class="card-lesen" role="tabpanel" aria-labelledby="tab-vf" style="display:none;">
      <div class="title-row">
        <i id="vf-icon" class="fa-solid fa-circle-info"></i>
        <strong id="vf-tipo">[Aviso del edificio]</strong>
        <span class="muted" id="vf-progress">1 / 15</span>
      </div>
      <div id="vf-text" class="mini-text"></div>

      <div class="q-block">
        <div class="mc-row"><strong>1.</strong> <span id="vf-a1"></span></div>
        <ul class="opts">
          <li><label><input type="radio" name="vf1" value="true"> Wahr</label></li>
          <li><label><input type="radio" name="vf1" value="false"> Falsch</label></li>
        </ul>
        <p id="vf-fb1"></p>
      </div>
      <div class="q-block">
        <div class="mc-row"><strong>2.</strong> <span id="vf-a2"></span></div>
        <ul class="opts">
          <li><label><input type="radio" name="vf2" value="true"> Wahr</label></li>
          <li><label><input type="radio" name="vf2" value="false"> Falsch</label></li>
        </ul>
        <p id="vf-fb2"></p>
      </div>
      <div class="q-block">
        <div class="mc-row"><strong>3.</strong> <span id="vf-a3"></span></div>
        <ul class="opts">
          <li><label><input type="radio" name="vf3" value="true"> Wahr</label></li>
          <li><label><input type="radio" name="vf3" value="false"> Falsch</label></li>
        </ul>
        <p id="vf-fb3"></p>
      </div>

      <div class="controls">
        <button class="btn-submit" id="vf-check" type="button">Comprobar</button>
        <button class="btn-ghost" id="vf-prev" type="button">‚üµ Anterior</button>
        <button class="btn-ghost" id="vf-next" type="button">Siguiente ‚ü∂</button>
        <button class="btn-ghost" id="vf-reset" type="button"><i class="fa-solid fa-rotate-left"></i> Reiniciar</button>
        <span id="vf-score" class="score"></span>
      </div>
    </div>
  </div>

  <!-- Modal de glosario (√∫nico para esta secci√≥n) -->
  <div id="gloss-modal-lesen" class="modal-lesen hidden" role="dialog" aria-modal="true" aria-labelledby="gloss-term-lesen" aria-describedby="gloss-def-lesen">
    <div class="modal-box">
      <button id="gloss-close-lesen" class="modal-close" aria-label="Cerrar">√ó</button>
      <h4 id="gloss-term-lesen">T√©rmino</h4>
      <p id="gloss-def-lesen">Definici√≥n en espa√±ol</p>
    </div>
  </div>

  <span class="back-btn" onclick="mostrarSeccion('home')">Volver al inicio</span>

  <script>
  (function(){
    /* ========= Glosario (palabras dif√≠ciles) ========= */
    const GLOSS = {
      "Betreff":"asunto (en un correo).",
      "Treffpunkt":"punto de encuentro.",
      "Turnhalle":"gimnasio o coliseo escolar.",
      "Trinkflasche":"botella de agua.",
      "Versp√§tung":"retraso, demora.",
      "Einlass":"ingreso/entrada permitida.",
      "Mensa":"comedor escolar/universitario.",
      "Ausleihe":"pr√©stamo (de libros, etc.).",
      "Praxis":"consultorio m√©dico.",
      "R√ºckgabeautomat":"m√°quina para devoluci√≥n (de libros).",
      "Beratung":"asesor√≠a/atenci√≥n al p√∫blico.",
      "gesperrt":"cerrado/bloqueado.",
      "Linie":"l√≠nea (de bus/metro).",
      "Ersatzbus":"bus de reemplazo.",
      "Taschenrechner":"calculadora.",
      "Notenheft":"cuaderno de partituras.",
      "verschoben":"aplazado/reprogramado.",
      "Versicherungskarte":"tarjeta de seguro m√©dico.",
      "Ausweis":"documento de identidad.",
      "Schneegefahr":"peligro de nieve.",
      "Foyer":"vest√≠bulo/entrada de un edificio.",
      "Eintritt":"entrada (boleto) / costo de entrada."
    };

    /* ========= Utilidades ========= */
    const byId = id => document.getElementById(id);
    // resalta t√©rminos con span.gloss
    function highlightGloss(text){
      // Ordenar claves por longitud para evitar solapamientos
      const keys = Object.keys(GLOSS).sort((a,b)=>b.length-a.length);
      let out = text;
      keys.forEach(k=>{
        const rx = new RegExp(`\\b${escapeRegExp(k)}\\b`,'g');
        out = out.replace(rx, `<span class="gloss" data-term="${k}">${k}</span>`);
      });
      return out;
    }
    function escapeRegExp(s){ return s.replace(/[.*+?^${}()|[\]\\]/g,'\\$&'); }
    function attachGlossHandlers(scope){
      scope.querySelectorAll('.gloss').forEach(el=>{
        el.addEventListener('click', ()=> showGloss(el.dataset.term));
      });
    }
    function showGloss(term){
      const modal = byId('gloss-modal-lesen');
      byId('gloss-term-lesen').textContent = term;
      byId('gloss-def-lesen').textContent = GLOSS[term] || 'Sin definici√≥n registrada.';
      modal.classList.remove('hidden');
    }
    byId('gloss-close-lesen').addEventListener('click', ()=> byId('gloss-modal-lesen').classList.add('hidden'));

    /* ========= Banco A) Mini-textos (15) ========= */
    const ICONS = {
      "Correo escolar": "fa-envelope-open-text",
      "Mensaje de m√≥vil": "fa-mobile-screen",
      "Aviso escolar": "fa-school",
      "Correo de biblioteca": "fa-book",
      "Mensaje del entrenador": "fa-person-running",
      "Anuncio de cine": "fa-film",
      "Nota del profesor": "fa-chalkboard-user",
      "Correo de excursi√≥n": "fa-train-subway",
      "Aviso del supermercado": "fa-basket-shopping",
      "Mensaje de consulta m√©dica": "fa-user-doctor",
      "Correo de biblioteca escolar": "fa-book-open-reader",
      "Anuncio de transporte": "fa-bus",
      "Mensaje de clase de m√∫sica": "fa-music",
      "Correo de cumplea√±os": "fa-cake-candles",
      "Aviso del tiempo": "fa-cloud-sun-rain"
    };

    const MINI = [
      {
        tipo:"Correo escolar",
        text:`<strong>Betreff</strong>: Klassenfahrt<br>
        Liebe Eltern, am Freitag fahren wir um 7:30 Uhr mit dem Bus nach Bremen. <strong>Treffpunkt</strong> ist vor der <strong>Turnhalle</strong>. Bitte geben Sie den Kindern eine <strong>Trinkflasche</strong> und ein Sandwich mit.`,
        q1:"¬øCu√°ndo es la salida (Abfahrt)?",
        opts1:["7:00 Uhr","7:30 Uhr","8:00 Uhr"], ans1:1,
        q2:"¬øD√≥nde es el punto de encuentro (Treffpunkt)?",
        opts2:["Vor der Turnhalle","Am Lehrerzimmer","Im Klassenzimmer"], ans2:0
      },
      {
        tipo:"Mensaje de m√≥vil",
        text:`Hi Ben, ich komme heute sp√§ter. Mein Zug hat 15 Minuten <strong>Versp√§tung</strong>. Warte bitte vor dem Kino. ‚Äì Max`,
        q1:"¬øD√≥nde debe esperar Ben?",
        opts1:["Vor der Schule","Vor dem Kino","Am Bahnhof"], ans1:1,
        q2:"¬øCu√°nto es el retraso?",
        opts2:["10 Minuten","20 Minuten","15 Minuten"], ans2:2
      },
      {
        tipo:"Aviso escolar",
        text:`<strong>Mensa</strong>: Heute gibt es vegetarische Pasta und Salat. Das Mittagessen kostet 4,00 ‚Ç¨. Wasser ist kostenlos.`,
        q1:"¬øCu√°nto cuesta el almuerzo?",
        opts1:["2,50 ‚Ç¨","4,00 ‚Ç¨","5,00 ‚Ç¨"], ans1:1,
        q2:"¬øQu√© es gratuito?",
        opts2:["Salat","Wasser","Pasta"], ans2:1
      },
      {
        tipo:"Correo de biblioteca",
        text:`Ihre <strong>Ausleihe</strong>: ‚ÄûDie kleine Hexe‚Äú. Bitte bringen Sie das Buch bis Mittwoch zur√ºck. Die Bibliothek ist von 9‚Äì17 Uhr ge√∂ffnet.`,
        q1:"¬øHasta cu√°ndo se debe devolver el libro?",
        opts1:["Donnerstag","Mittwoch","Freitag"], ans1:1,
        q2:"¬øA qu√© hora abre la biblioteca?",
        opts2:["9 Uhr","8 Uhr","10 Uhr"], ans2:0
      },
      {
        tipo:"Mensaje del entrenador",
        text:`Hallo Team, das Training ist heute in der Sporthalle, nicht auf dem Platz. Bitte saubere Turnschuhe mitbringen.`,
        q1:"¬øD√≥nde es el entrenamiento?",
        opts1:["Auf dem Platz","In der Sporthalle","Im Park"], ans1:1,
        q2:"¬øQu√© deben traer?",
        opts2:["Fu√üballschuhe","Saubere Turnschuhe","Jacke"], ans2:1
      },
      {
        tipo:"Anuncio de cine",
        text:`Film ‚ÄûSternennacht‚Äú: Beginn 18:45 Uhr, Saal 3. Tickets nur online. <strong>Einlass</strong> ab 18:15 Uhr.`,
        q1:"¬øCu√°ndo empieza la pel√≠cula?",
        opts1:["18:15 Uhr","19:00 Uhr","18:45 Uhr"], ans1:2,
        q2:"¬øD√≥nde se compran los tickets?",
        opts2:["An der Kasse","Online","Im Laden"], ans2:1
      },
      {
        tipo:"Nota del profesor",
        text:`Morgen schreiben wir einen kurzen Test in Mathematik. Bitte bringt <strong>Taschenrechner</strong> und Lineal mit.`,
        q1:"¬øDe qu√© materia es la prueba?",
        opts1:["Deutsch","Mathematik","Englisch"], ans1:1,
        q2:"¬øQu√© deben traer?",
        opts2:["Zirkel","Taschenrechner und Lineal","W√∂rterbuch"], ans2:1
      },
      {
        tipo:"Correo de excursi√≥n",
        text:`Liebe Sch√ºler, wir treffen uns um 9:00 Uhr am Bahnhof. Denkt an eine Fahrkarte und Regenjacke.`,
        q1:"¬øD√≥nde se encuentran?",
        opts1:["Vor der Schule","Am Bahnhof","Im Bus"], ans1:1,
        q2:"¬øQu√© deben llevar?",
        opts2:["Sonnenbrille","Fahrkarte und Regenjacke","Badehose"], ans2:1
      },
      {
        tipo:"Aviso del supermercado",
        text:`Angebot: √Ñpfel 1,99 ‚Ç¨/kg, Bananen 1,49 ‚Ç¨/kg. Heute ge√∂ffnet bis 21 Uhr.`,
        q1:"¬øCu√°nto cuesta 1 kg de bananos?",
        opts1:["1,49 ‚Ç¨","1,99 ‚Ç¨","2,49 ‚Ç¨"], ans1:0,
        q2:"¬øHasta qu√© hora est√° abierto hoy?",
        opts2:["20 Uhr","21 Uhr","22 Uhr"], ans2:1
      },
      {
        tipo:"Mensaje de consulta m√©dica",
        text:`Ihr Termin: Mittwoch, 10:20 Uhr, <strong>Praxis</strong> Dr. Klein, Zimmer 2. Bitte 10 Minuten fr√ºher kommen.`,
        q1:"¬øCu√°ndo es la cita?",
        opts1:["Dienstag","Mittwoch","Donnerstag"], ans1:1,
        q2:"¬øQu√© se debe hacer?",
        opts2:["Llegar 10 minutos m√°s tarde","Llegar 10 minutos antes","Llegar exactamente 10:20"], ans2:1
      },
      {
        tipo:"Correo de biblioteca escolar",
        text:`Am Freitag ist B√ºchertausch in der Schulbibliothek. Bringt bitte un libro le√≠do y lleven uno nuevo.`,
        q1:"¬øD√≥nde es la actividad?",
        opts1:["In der Turnhalle","In der Schulbibliothek","Auf dem Schulhof"], ans1:1,
        q2:"¬øQu√© deben llevar?",
        opts2:["Eine Zeitschrift","Ein gelesenes Buch","Ein Heft"], ans2:1
      },
      {
        tipo:"Anuncio de transporte",
        text:`Wegen Bauarbeiten f√§hrt die <strong>Linie</strong> 5 heute nicht. Nutzen Sie bitte die Linie 3 oder den <strong>Ersatzbus</strong>.`,
        q1:"¬øQu√© l√≠nea no funciona hoy?",
        opts1:["Linie 3","Linie 5","Linie 7"], ans1:1,
        q2:"¬øQu√© se puede tomar en su lugar?",
        opts2:["Linie 9","Linie 3 oder Ersatzbus","Taxi"], ans2:1
      },
      {
        tipo:"Mensaje de clase de m√∫sica",
        text:`Bitte bringt morgen eure Fl√∂te und das <strong>Notenheft</strong> mit. Wir √ºben das Lied ‚ÄûGuten Morgen‚Äú.`,
        q1:"¬øQu√© se va a practicar?",
        opts1:["Das Lied ‚ÄûGuten Morgen‚Äú","Ein neues Gedicht","Ein Theaterst√ºck"], ans1:0,
        q2:"¬øQu√© deben traer?",
        opts2:["Gitarre","Fl√∂te und Notenheft","Kopfh√∂rer"], ans2:1
      },
      {
        tipo:"Correo de cumplea√±os",
        text:`Hallo Lara, yo festejo el s√°bado a las 16 Uhr en mi casa. Por favor trae algo para beber. ‚Äì Mia`,
        q1:"¬øA qu√© hora empieza la fiesta?",
        opts1:["15 Uhr","16 Uhr","17 Uhr"], ans1:1,
        q2:"¬øQu√© debe traer Lara?",
        opts2:["Kuchen","Etwas zu trinken","Luftballons"], ans2:1
      },
      {
        tipo:"Aviso del tiempo",
        text:`Wetter heute: Vormittags sonnig, nachmittags Regen. ¬°No olvides la chaqueta impermeable!`,
        q1:"¬øC√≥mo est√° el clima en la ma√±ana?",
        opts1:["Sonnig","Windig","Neblig"], ans1:0,
        q2:"¬øQu√© se espera en la tarde?",
        opts2:["Schnee","Regen","Sturm"], ans2:1
      }
    ];

    /* ========= Banco B) Verdadero/Falso (15) ========= */
    const VF = [
      {
        tipo:"Aviso del edificio",
        text:`Wegen Reinigung bleibt die Waschk√ºche am Montag von 9 bis 13 Uhr geschlossen.`,
        a1:"La lavander√≠a (Waschk√ºche) est√° cerrada el lunes en la ma√±ana.",
        a2:"La lavander√≠a abre a las 9 en punto.",
        a3:"La limpieza dura cuatro horas.",
        key:[true, false, true]
      },
      {
        tipo:"Anuncio escolar",
        text:`Der Schulhof ist wegen Bauarbeiten <strong>gesperrt</strong>. Der Eingang A bleibt offen.`,
        a1:"El patio escolar (Schulhof) est√° abierto.",
        a2:"Se puede usar la Entrada A.",
        a3:"Las obras han terminado.",
        key:[false, true, false]
      },
      {
        tipo:"Nota m√©dica",
        text:`Die <strong>Praxis</strong> ist heute nur bis 12 Uhr ge√∂ffnet. Recetas (Rezepte) desde las 10.`,
        a1:"El consultorio cierra al mediod√≠a.",
        a2:"Las recetas se entregan solo desde las 12.",
        a3:"Se pueden obtener recetas desde las 10.",
        key:[true, false, true]
      },
      {
        tipo:"Biblioteca",
        text:`<strong>R√ºckgabeautomat</strong>: abierto 24 horas. <strong>Beratung</strong> solo de 10‚Äì18 Uhr.`,
        a1:"La m√°quina de devoluci√≥n est√° siempre abierta.",
        a2:"La asesor√≠a es 24 horas.",
        a3:"La asesor√≠a termina a las 18.",
        key:[true, false, true]
      },
      {
        tipo:"Transporte",
        text:`El tren a Hamburgo <em>f√§llt aus</em> (no sale) hoy. Tome el tren de 10:15 a Bremen.`,
        a1:"El tren a Hamburgo hoy no sale.",
        a2:"Hay alternativa a las 10:15.",
        a3:"La alternativa va a Hamburgo.",
        key:[true, true, false]
      },
      {
        tipo:"Supermercado",
        text:`Caja 2 est√° cerrada. Por favor ir a Caja 3.`,
        a1:"Se puede usar la Caja 2.",
        a2:"La Caja 3 est√° abierta.",
        a3:"Todas las cajas est√°n cerradas.",
        key:[false, true, false]
      },
      {
        tipo:"Clase de deporte",
        text:`Hoy deporte al aire libre. Traer una chaqueta.`,
        a1:"Hoy el deporte es en el coliseo.",
        a2:"Se recomienda chaqueta.",
        a3:"La clase se cancela.",
        key:[false, true, false]
      },
      {
        tipo:"Piscina",
        text:`Piscina: D√≠a familiar el domingo. Ni√±os no pagan <strong>Eintritt</strong>.`,
        a1:"El domingo hay d√≠a familiar.",
        a2:"Los ni√±os deben pagar entrada.",
        a3:"La piscina est√° cerrada el domingo.",
        key:[true, false, false]
      },
      {
        tipo:"Restaurante",
        text:`Men√∫ de almuerzo de 11:30 a 14:30. Bebidas no incluidas.`,
        a1:"El men√∫ empieza a las 11:30.",
        a2:"Las bebidas est√°n incluidas.",
        a3:"El men√∫ termina a las 14:30.",
        key:[true, false, true]
      },
      {
        tipo:"Correo de profesor",
        text:`La prueba se <strong>verschoben</strong> (aplaza) para el viernes. Repetir el cap√≠tulo 3.`,
        a1:"La prueba es antes.",
        a2:"Se debe repasar el cap√≠tulo 3.",
        a3:"La prueba es el viernes.",
        key:[false, true, true]
      },
      {
        tipo:"M√©dico",
        text:`Por favor traer su <strong>Versicherungskarte</strong> y su <strong>Ausweis</strong> a la cita.`,
        a1:"Se necesita la tarjeta del seguro.",
        a2:"No es necesario documento de identidad.",
        a3:"Se trata de una cita.",
        key:[true, false, true]
      },
      {
        tipo:"Clima",
        text:`Ma√±ana <strong>Schneegefahr</strong> (riesgo de nieve). Los buses pueden salir tarde.`,
        a1:"Puede nevar ma√±ana.",
        a2:"Los buses saldr√°n puntuales con seguridad.",
        a3:"Son posibles retrasos.",
        key:[true, false, true]
      },
      {
        tipo:"Aula",
        text:`La clase hoy es en el sal√≥n 105, no en el 101.`,
        a1:"La clase es en el 101.",
        a2:"El sal√≥n correcto es 105.",
        a3:"La clase se cancela.",
        key:[false, true, false]
      },
      {
        tipo:"Entrega de tareas",
        text:`Subir la tarea hasta el domingo 20:00 en la plataforma.`,
        a1:"La entrega es el domingo.",
        a2:"La hora es 22:00.",
        a3:"La entrega es en l√≠nea.",
        key:[true, false, true]
      },
      {
        tipo:"Exposici√≥n escolar",
        text:`La exposici√≥n ‚ÄúNuestra ciudad‚Äù es el jueves en el <strong>Foyer</strong>. <strong>Eintritt</strong> gratis.`,
        a1:"La exposici√≥n es el jueves.",
        a2:"La entrada cuesta 5 euros.",
        a3:"La exposici√≥n es en el vest√≠bulo.",
        key:[true, false, true]
      }
    ];

    /* ========= Estado y elementos ========= */
    // Tabs
    const tabMini = byId('tab-mini'), tabVF = byId('tab-vf');
    const miniPanel = byId('mini-panel'), vfPanel = byId('vf-panel');

    // Mini-textos
    let miniIdx = 0, miniScore = 0, miniDone = Array(MINI.length).fill(false);
    const miniIcon = byId('mini-icon'), miniTipo = byId('mini-tipo'), miniProg = byId('mini-progress');
    const miniText = byId('mini-text');
    const miniQ1 = byId('mini-q1'), miniOpts1 = byId('mini-opts1'), miniFb1 = byId('mini-fb1');
    const miniQ2 = byId('mini-q2'), miniOpts2 = byId('mini-opts2'), miniFb2 = byId('mini-fb2');
    const miniCheck = byId('mini-check'), miniPrev = byId('mini-prev'), miniNext = byId('mini-next'),
          miniReset = byId('mini-reset'), miniScoreEl = byId('mini-score');

    // Verdadero/Falso
    let vfIdx = 0, vfScore = 0, vfDone = Array(VF.length).fill(false);
    const vfIcon = byId('vf-icon'), vfTipo = byId('vf-tipo'), vfProg = byId('vf-progress');
    const vfText = byId('vf-text');
    const a1 = byId('vf-a1'), a2 = byId('vf-a2'), a3 = byId('vf-a3');
    const vfFb1 = byId('vf-fb1'), vfFb2 = byId('vf-fb2'), vfFb3 = byId('vf-fb3');
    const vfCheck = byId('vf-check'), vfPrev = byId('vf-prev'), vfNext = byId('vf-next'),
          vfReset = byId('vf-reset'), vfScoreEl = byId('vf-score');

    /* ========= Render Mini-textos ========= */
    function renderMini(i){
      const m = MINI[i];
      // encabezado
      miniTipo.textContent = `[${m.tipo}]`;
      miniIcon.className = `fa-solid ${ICONS[m.tipo] || 'fa-file-lines'}`;
      miniProg.textContent = `${i+1} / ${MINI.length}`;
      // texto con glosario
      miniText.innerHTML = highlightGloss(m.text);
      attachGlossHandlers(miniText);

      // Pregunta 1
      miniQ1.innerHTML = `<strong>1.</strong> ${m.q1}`;
      miniOpts1.innerHTML = m.opts1.map((o, idx)=>(
        `<li><label><input type="radio" name="mini1" value="${idx}"> ${String.fromCharCode(97+idx)}) ${o}</label></li>`
      )).join('');
      miniFb1.textContent = '';

      // Pregunta 2
      miniQ2.innerHTML = `<strong>2.</strong> ${m.q2}`;
      miniOpts2.innerHTML = m.opts2.map((o, idx)=>(
        `<li><label><input type="radio" name="mini2" value="${idx}"> ${String.fromCharCode(97+idx)}) ${o}</label></li>`
      )).join('');
      miniFb2.textContent = '';

      miniScoreEl.textContent = `Puntaje: ${miniScore} / ${MINI.length*2}`;
    }
    function checkMini(){
      const m = MINI[miniIdx];
      let add = 0;

      const pick1 = document.querySelector('input[name="mini1"]:checked');
      if (!pick1){ miniFb1.textContent = 'Elige una opci√≥n.'; miniFb1.className='bad'; }
      else if (+pick1.value === m.ans1){ miniFb1.textContent = '¬°Correcto!'; miniFb1.className='ok'; add++; }
      else { miniFb1.textContent = `Incorrecto. Respuesta: ${String.fromCharCode(97+m.ans1)}) ${m.opts1[m.ans1]}`; miniFb1.className='bad'; }

      const pick2 = document.querySelector('input[name="mini2"]:checked');
      if (!pick2){ miniFb2.textContent = 'Elige una opci√≥n.'; miniFb2.className='bad'; }
      else if (+pick2.value === m.ans2){ miniFb2.textContent = '¬°Correcto!'; miniFb2.className='ok'; add++; }
      else { miniFb2.textContent = `Incorrecto. Respuesta: ${String.fromCharCode(97+m.ans2)}) ${m.opts2[m.ans2]}`; miniFb2.className='bad'; }

      if (!miniDone[miniIdx]) { miniScore += add; miniDone[miniIdx] = true; }
      miniScoreEl.textContent = `Puntaje: ${miniScore} / ${MINI.length*2}`;
    }

    /* ========= Render Verdadero/Falso ========= */
    function renderVF(i){
      const v = VF[i];
      vfTipo.textContent = `[${v.tipo}]`;
      vfIcon.className = `fa-solid ${ICONS[v.tipo] || 'fa-circle-info'}`;
      vfProg.textContent = `${i+1} / ${VF.length}`;
      vfText.innerHTML = highlightGloss(v.text);
      attachGlossHandlers(vfText);
      a1.innerHTML = v.a1; a2.innerHTML = v.a2; a3.innerHTML = v.a3;
      // limpiar selecciones
      ['vf1','vf2','vf3'].forEach(n => document.querySelectorAll(`input[name="${n}"]`).forEach(r=> r.checked=false));
      vfFb1.textContent = vfFb2.textContent = vfFb3.textContent = '';
      vfScoreEl.textContent = `Puntaje: ${vfScore} / ${VF.length*3}`;
    }
    function checkVF(){
      const v = VF[vfIdx];
      let add = 0;
      const c1 = document.querySelector('input[name="vf1"]:checked');
      const c2 = document.querySelector('input[name="vf2"]:checked');
      const c3 = document.querySelector('input[name="vf3"]:checked');

      if (!c1){ vfFb1.textContent = 'Selecciona una opci√≥n.'; vfFb1.className='bad'; }
      else if ((c1.value==='true') === v.key[0]){ vfFb1.textContent='¬°Correcto!'; vfFb1.className='ok'; add++; }
      else { vfFb1.textContent = `Incorrecto. Es ${v.key[0] ? 'Wahr' : 'Falsch'}.`; vfFb1.className='bad'; }

      if (!c2){ vfFb2.textContent = 'Selecciona una opci√≥n.'; vfFb2.className='bad'; }
      else if ((c2.value==='true') === v.key[1]){ vfFb2.textContent='¬°Correcto!'; vfFb2.className='ok'; add++; }
      else { vfFb2.textContent = `Incorrecto. Es ${v.key[1] ? 'Wahr' : 'Falsch'}.`; vfFb2.className='bad'; }

      if (!c3){ vfFb3.textContent = 'Selecciona una opci√≥n.'; vfFb3.className='bad'; }
      else if ((c3.value==='true') === v.key[2]){ vfFb3.textContent='¬°Correcto!'; vfFb3.className='ok'; add++; }
      else { vfFb3.textContent = `Incorrecto. Es ${v.key[2] ? 'Wahr' : 'Falsch'}.`; vfFb3.className='bad'; }

      if (!vfDone[vfIdx]) { vfScore += add; vfDone[vfIdx] = true; }
      vfScoreEl.textContent = `Puntaje: ${vfScore} / ${VF.length*3}`;
    }

    /* ========= Eventos ========= */
    // Tabs
    tabMini.addEventListener('click', ()=>{
      tabMini.classList.add('active'); tabVF.classList.remove('active');
      miniPanel.style.display='block'; vfPanel.style.display='none';
      window.scrollTo({top: miniPanel.getBoundingClientRect().top + window.scrollY - 80, behavior:'smooth'});
    });
    tabVF.addEventListener('click', ()=>{
      tabVF.classList.add('active'); tabMini.classList.remove('active');
      vfPanel.style.display='block'; miniPanel.style.display='none';
      window.scrollTo({top: vfPanel.getBoundingClientRect().top + window.scrollY - 80, behavior:'smooth'});
    });

    // Mini
    miniCheck.addEventListener('click', checkMini);
    miniPrev.addEventListener('click', ()=>{ miniIdx = (miniIdx - 1 + MINI.length) % MINI.length; renderMini(miniIdx); });
    miniNext.addEventListener('click', ()=>{ miniIdx = (miniIdx + 1) % MINI.length; renderMini(miniIdx); });
    miniReset.addEventListener('click', ()=>{
      miniScore = 0; miniDone = Array(MINI.length).fill(false); renderMini(miniIdx=0);
    });

    // VF
    vfCheck.addEventListener('click', checkVF);
    vfPrev.addEventListener('click', ()=>{ vfIdx = (vfIdx - 1 + VF.length) % VF.length; renderVF(vfIdx); });
    vfNext.addEventListener('click', ()=>{ vfIdx = (vfIdx + 1) % VF.length; renderVF(vfIdx); });
    vfReset.addEventListener('click', ()=>{
      vfScore = 0; vfDone = Array(VF.length).fill(false); renderVF(vfIdx=0);
    });

    /* ========= Inicializaci√≥n ========= */
    // Render primeros √≠tems
    renderMini(0);
    renderVF(0);

    // Activar glosario en texto introductorio
    attachGlossHandlers(document.getElementById('lesen'));
  })();
  </script>
</section>


  <!-- REDEMITTEL -->
  <section id="redemittel" class="contenido-oculto">
    <h2>Redemittel √ºben</h2>
    <p>Lerne n√ºtzliche S√§tze f√ºr den Alltag und Pr√ºfungssituationen.</p>

    <h3>Flashcards</h3>
    <div class="flashcard-container">
      <div class="flashcard" onclick="this.classList.toggle('show')">
        <i class="fa-solid fa-school"></i>
        <span class="word">In der Schule: Ich habe meine Hausaufgaben nicht gemacht.</span>
      </div>
      <div class="flashcard" onclick="this.classList.toggle('show')">
        <i class="fa-solid fa-store"></i>
        <span class="word">Im Supermarkt: Kann ich mit Karte zahlen?</span>
      </div>
      <div class="flashcard" onclick="this.classList.toggle('show')">
        <i class="fa-solid fa-bus"></i>
        <span class="word">An der Bushaltestelle: F√§hrt dieser Bus nach Berlin?</span>
      </div>
    </div>
    <p>Tipp: Klicke auf die Karten, um die Redemittel zu sehen.</p>

    <h3>Dialog erg√§nzen</h3>
    <p>A: "Guten Tag! Wie kann ich Ihnen helfen?"</p>
    <p>B: "_____"</p>
    <ul>
      <li><input type="radio" name="dlg1" value="a"> a) Mir geht es gut.</li>
      <li><input type="radio" name="dlg1" value="b"> b) Ich habe zwei Tickets bestellt.</li>
      <li><input type="radio" name="dlg1" value="c"> c) Ich m√∂chte bezahlen.</li>
    </ul>
    <button class="btn-submit" onclick="checkMC('dlg1', 'c', 'dlg1-result')">√úberpr√ºfen</button>
    <p id="dlg1-result"></p>

    <span class="back-btn" onclick="mostrarSeccion('home')">Zur√ºck</span>
  </section>

  <!-- QUIZ-MODUS -->
  <section id="quiz" class="contenido-oculto">
    <h2>Quiz-Modus</h2>
    <p>Teste dein Wissen schnell und spielerisch!</p>

    <div id="quiz-content">
      <div class="quiz-question">
        <p>1. Wie hei√üt "Katze" auf Deutsch?</p>
        <ul class="quiz-options">
          <li><label><input type="radio" name="quizQ1" value="a"> a) der Hund</label></li>
          <li><label><input type="radio" name="quizQ1" value="b"> b) die Katze</label></li>
          <li><label><input type="radio" name="quizQ1" value="c"> c) die Maus</label></li>
        </ul>
      </div>
      <div class="quiz-question">
        <p>2. "Ich gehe ___ Schule."</p>
        <ul class="quiz-options">
          <li><label><input type="radio" name="quizQ2" value="a"> a) in der</label></li>
          <li><label><input type="radio" name="quizQ2" value="b"> b) zur</label></li>
          <li><label><input type="radio" name="quizQ2" value="c"> c) zum</label></li>
        </ul>
      </div>
      <div class="quiz-question">
        <p>3. "Heute ist Samstag." - Wahr oder Falsch?</p>
        <ul class="quiz-options">
          <li><label><input type="radio" name="quizQ3" value="true"> Wahr</label></li>
          <li><label><input type="radio" name="quizQ3" value="false"> Falsch</label></li>
        </ul>
      </div>
      <button class="btn-submit" onclick="checkQuizAnswers()">Ergebnisse anzeigen</button>
      <p id="quiz-result" class="result"></p>
    </div>

    <span class="back-btn" onclick="mostrarSeccion('home')">Zur√ºck</span>
  </section>

  <!-- SIMULATIONSF√úHRUNG EXAMEN -->
  <section id="simulation" class="contenido-oculto">
    <h2>Simulationspr√ºfung</h2>
    <p>Absolviere einen vollst√§ndigen A2-Test!</p>

    <div class="exam-section" id="exam-vocab">
      <h3>1. Wortschatz: Welche √úbersetzung passt zum Bild?</h3>
      <i class="fa-solid fa-car"></i> <span>das Auto</span><br>
      <input type="radio" name="exam1" value="richtig"> Richtig<br>
      <input type="radio" name="exam1" value="falsch"> Falsch
    </div>

    <div class="exam-section" id="exam-grammar">
      <h3>2. Grammatik: Erg√§nze den Satz:</h3>
      <p>Er ___ jeden Tag zur Schule. (geht)</p>
      <input type="text" id="exam2" placeholder="Antwort">
    </div>

    <div class="exam-section" id="exam-reading">
      <h3>3. Leseverstehen: Kurznachricht lesen</h3>
      <p>Max: Hallo! Kommen deine Eltern heute zu Besuch?</p>
      <p>Sophie: Ja, sie kommen um 18 Uhr. Ich muss aber noch Hausaufgaben machen.</p>
      <p>Frage: Wann kommen Sophies Eltern?</p>
      <input type="text" id="exam3" placeholder="Antwort">
    </div>

    <div class="exam-section" id="exam-expressions">
      <h3>4. Redemittel: F√ºlle ein Gespr√§chsthema ein</h3>
      <p>A: "Entschuldigung, ...?"</p>
      <input type="text" id="exam4" placeholder="Ihre Frage (z.B. Wie sp√§t ist es)">
    </div>

    <button class="btn-submit" onclick="submitExam()">Pr√ºfung abschlie√üen</button>
    <p id="exam-result" class="result"></p>

    <span class="back-btn" onclick="mostrarSeccion('home')">Zur√ºck</span>
  </section>

  <script>
    function mostrarSeccion(id) {
      document.querySelectorAll("section").forEach(sec => sec.style.display = "none");
      document.getElementById(id).style.display = "block";
      window.scrollTo({ top: 0, behavior: "smooth" });
    }

    // Drag and Drop f√ºr Grammatik
    const items = document.querySelectorAll('.dnd-item');
    items.forEach(item => {
      item.addEventListener('dragstart', dragStart);
    });
    const zones = document.querySelectorAll('.dnd-zone');
    zones.forEach(zone => {
      zone.addEventListener('dragover', allowDrop);
      zone.addEventListener('drop', drop);
    });
    function dragStart(event) {
      event.dataTransfer.setData("text", event.target.innerText);
    }
    function allowDrop(event) {
      event.preventDefault();
    }
    function drop(event) {
      event.preventDefault();
      const word = event.dataTransfer.getData("text");
      if (event.target.classList.contains('dnd-zone') && event.target.childElementCount === 0) {
        const item = document.createElement('div');
        item.className = 'dnd-item';
        item.innerText = word;
        event.target.appendChild(item);
        // Remove word from source
        items.forEach(i => {
          if (i.innerText === word) i.style.visibility = 'hidden';
        });
      }
    }
    function checkSentence() {
      const words = [];
      zones.forEach(zone => {
        if (zone.firstChild) words.push(zone.firstChild.textContent);
      });
      const resultElem = document.getElementById('dnd-result');
      if (words.join(' ') === 'ich spiele Fu√üball') {
        resultElem.textContent = 'Richtig! Gut gemacht!';
        resultElem.style.color = 'green';
      } else {
        resultElem.textContent = 'Falsch. Versuche es noch einmal!';
        resultElem.style.color = 'red';
      }
    }

    function checkMC(name, correctValue, resultId) {
      const options = document.getElementsByName(name);
      let selected;
      options.forEach(opt => { if (opt.checked) selected = opt.value; });
      const resultElem = document.getElementById(resultId);
      if (!selected) {
        resultElem.textContent = 'Bitte w√§hle eine Antwort.';
        resultElem.style.color = 'orange';
      } else if (selected === correctValue) {
        resultElem.textContent = 'Richtig!';
        resultElem.style.color = 'green';
      } else {
        resultElem.textContent = 'Falsch.';
        resultElem.style.color = 'red';
      }
    }
    function checkFill(inputId, answer, resultId) {
      const val = document.getElementById(inputId).value.trim().toLowerCase();
      const resultElem = document.getElementById(resultId);
      if (!val) {
        resultElem.textContent = 'Bitte einen Wert eingeben.';
        resultElem.style.color = 'orange';
      } else if (val === answer) {
        resultElem.textContent = 'Richtig!';
        resultElem.style.color = 'green';
      } else {
        resultElem.textContent = 'Falsch.';
        resultElem.style.color = 'red';
      }
    }
    function checkTrueFalse(name, correctBool, resultId) {
      const options = document.getElementsByName(name);
      let selected;
      options.forEach(opt => { if (opt.checked) selected = opt.value; });
      const resultElem = document.getElementById(resultId);
      if (!selected) {
        resultElem.textContent = 'Bitte w√§hle aus.';
        resultElem.style.color = 'orange';
      } else if ((selected === 'true') === correctBool) {
        resultElem.textContent = 'Wahr!';
        resultElem.style.color = 'green';
      } else {
        resultElem.textContent = 'Falsch.';
        resultElem.style.color = 'red';
      }
    }

    function checkQuizAnswers() {
      let score = 0;
      const q1 = document.querySelector('input[name="quizQ1"]:checked');
      const q2 = document.querySelector('input[name="quizQ2"]:checked');
      const q3 = document.querySelector('input[name="quizQ3"]:checked');
      if(q1 && q1.value === 'b') score++;
      if(q2 && q2.value === 'b') score++;
      if(q3 && q3.value === 'false') score++;
      const resultElem = document.getElementById('quiz-result');
      resultElem.textContent = 'Du hast ' + score + ' von 3 Punkten erreicht.';
    }

    // Simulationspr√ºfung
    function submitExam() {
      let total = 0, correct = 0;
      const exam1 = document.querySelector('input[name="exam1"]:checked');
      if (exam1 && exam1.value === 'richtig') correct++;
      total++;
      const exam2 = document.getElementById('exam2').value.trim().toLowerCase();
      if (exam2 === 'geht') correct++;
      total++;
      const exam3 = document.getElementById('exam3').value.trim();
      if (exam3 === '18 Uhr' || exam3 === '18 Uhr.') correct++;
      total++;
      const exam4 = document.getElementById('exam4').value.toLowerCase();
      if (exam4.includes('wie sp√§t')) correct++;
      total++;
      const resultElem = document.getElementById('exam-result');
      resultElem.textContent = 'Dein Ergebnis: ' + correct + ' von ' + total + ' richtig.';
      const history = JSON.parse(localStorage.getItem('examhistory') || '[]');
      history.push({score: correct + '/' + total, date: new Date().toLocaleString()});
      localStorage.setItem('examhistory', JSON.stringify(history));
    }

    // Initial load
    mostrarSeccion('home');
  </script>
</body>
</html>


